<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tienda Virtual</title>

  <!-- Tus estilos -->
  <link rel="stylesheet" href="./css/nav.css">
  <link rel="stylesheet" href="./css/index.css">

  <!-- SweetAlert opcional (si lo usas para confirmaciones) -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <style>
    /* Small helper to ensure map+form layout works if CSS missing */
    .contacto-grid { display:grid; grid-template-columns:1fr 1fr; gap:20px; }
    @media (max-width:768px) { .contacto-grid { grid-template-columns:1fr; } }
  </style>
</head>
<body>

  <!-- ===== HEADER ===== -->
  <header>
    <div class="logo">
      <img src="./img/logo.png" alt="Logo Tienda" />
      <h1>Tienda Virtual</h1>
    </div>

    <nav>
      <div class="menu-toggle" id="menuToggle" aria-hidden="false">☰</div>
      <ul id="navMenu">
        <li><a href="#">Inicio</a></li>
        <li class="dropdown" id="dropdownContainer">
          <a href="#" class="dropbtn" id="productosDrop">Productos ▾</a>
          <ul class="dropdown-content" id="dropdownCategorias">
            <!-- categorías dinámicas se insertan aquí -->
            <li><a href="#" data-cat="Todas">Todas</a></li>
          </ul>
        </li>
        <li><a href="#contacto">Contacto</a></li>
      </ul>
    </nav>

    <div class="header-actions">
      <button id="btn-login" class="btn-login">Iniciar sesión</button>

      <div class="carrito" id="carritoIcon" onclick="abrirCarrito()" aria-label="Abrir carrito" role="button" title="Carrito">
        <svg class="carrito-icon" width="22" height="22" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M3 3h2l1 5h13l-1.3 6.5a2 2 0 0 1-2 1.5H9" stroke="currentColor" stroke-width="1.5"/>
          <circle cx="11" cy="20" r="1" fill="currentColor"/>
          <circle cx="18" cy="20" r="1" fill="currentColor"/>
        </svg>
        <span class="carrito-count" id="carritoCount">0</span>
      </div>

      <div id="user-info" class="user-info" aria-live="polite" style="display:none;">
        <span id="user-nombre"></span>
        <button id="logout-btn" onclick="logout()">Cerrar sesión</button>
      </div>
    </div>
  </header>

  <!-- ===== CART (ASIDE) ===== -->
  <div class="overlay" id="overlay" onclick="cerrarCarrito()"></div>
  <aside class="carrito-modal" id="carritoModal" aria-hidden="true" role="dialog" aria-label="Carrito de compras">
    <div class="carrito-header">
      <h2>🛒 Tu Carrito</h2>
      <button class="close-modal" onclick="cerrarCarrito()" aria-label="Cerrar carrito">×</button>
    </div>

    <div class="carrito-items" id="carritoItems" aria-live="polite"></div>

    <div class="carrito-summary">
      <div id="carritoTotal" class="carrito-total">Total: S/ 0.00</div>
      <div class="carrito-actions">
        <button class="btn-pagar" onclick="procesarPagoPayPal()">💳 Pagar con PayPal</button>
        <button class="btn-mercadopago" onclick="procesarPagoSimulado()">💰 Mercado Pago</button>
        <button class="btn-vaciar" onclick="vaciarCarrito()">🗑️ Vaciar</button>
      </div>
    </div>
  </aside>

  <!-- ===== BANNER ===== -->
  <section class="banner">
    <img src="./img/banner/banner.jpg" alt="Banner principal" />
    <div class="banner-texto">Bienvenido a Tienda Virtual</div>
  </section>

  <!-- ===== PRODUCTOS ===== -->
  <main class="seccion-productos" id="mainProductos">
    <!-- JS llenará esto -->
  </main>

  <!-- ===== CONTACTO ===== -->
  <section class="seccion-contacto" id="contacto">
    <h2>Contáctanos</h2>
    <div class="contacto-grid">
      <form id="formContacto">
        <input type="text" id="contactNombre" placeholder="Tu nombre" required>
        <input type="email" id="contactEmail" placeholder="Tu correo" required>
        <input type="text" id="contactAsunto" placeholder="Asunto" required>
        <textarea id="contactMensaje" placeholder="Escribe tu mensaje..." rows="5" required></textarea>
        <button type="submit">Enviar Mensaje</button>
      </form>

      <div class="mapa-container" aria-hidden="false">
        <!-- Mapa funcional sin API key -->
        <iframe
          src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3901.781813555474!2d-77.02824692477333!3d-12.046171088175997!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x9105c5f619ee3ec7%3A0x14206cb9cc452b4a!2sLima!5e0!3m2!1ses!2spe!4v1690000000000!5m2!1ses!2spe"
          width="100%" height="100%" style="border:0; min-height:300px; border-radius:12px;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade">
        </iframe>
      </div>
    </div>
  </section>

  <!-- ===== FOOTER ===== -->
  <footer class="footer">
    <div class="footer-content">
      <div class="footer-section">
        <h3>Tienda Virtual</h3>
        <p>Tu tienda de confianza para compras en línea</p>
        <div class="social-links">
          <a href="#" aria-label="Facebook">📘 Facebook</a>
          <a href="#" aria-label="Instagram">📷 Instagram</a>
          <a href="#" aria-label="WhatsApp">💬 WhatsApp</a>
        </div>
      </div>
      
      <div class="footer-section">
        <h4>Enlaces Rápidos</h4>
        <ul>
          <li><a href="#">Inicio</a></li>
          <li><a href="#contacto">Contacto</a></li>
          <li><a href="./html/login.html">Iniciar Sesión</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h4>Contacto</h4>
        <p>📧 info@tiendavirtual.com</p>
        <p>📞 +51 987 654 321</p>
        <p>📍 Lima, Perú</p>
      </div>
      
      <div class="footer-section">
        <h4>Horario de Atención</h4>
        <p>Lunes a Viernes: 9:00 AM - 7:00 PM</p>
        <p>Sábados: 9:00 AM - 2:00 PM</p>
        <p>Domingos: Cerrado</p>
      </div>
    </div>
    
    <div class="footer-bottom">
      <p>&copy; 2024 Tienda Virtual. Todos los derechos reservados.</p>
    </div>
  </footer>

  <!-- Loader modal de pago -->
  <div id="modalCarga" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.6); z-index:9999; justify-content:center; align-items:center;">
    <div style="background:#222;padding:30px 50px;border-radius:12px;color:#fff;text-align:center;">
      <div style="border:5px solid #ccc;border-top:5px solid #4CAF50;border-radius:50%;width:50px;height:50px; margin:0 auto 12px; animation:spin 1s linear infinite;"></div>
      <div>Procesando su pago, por favor espere...</div>
    </div>
  </div>
  <style>@keyframes spin{from{transform:rotate(0)}to{transform:rotate(360deg)}}</style>

  <!-- Tu JS unificado -->
  <script src="./js/index.js" type="module"></script>
</body>
</html>